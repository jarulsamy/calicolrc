<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN"
   "http://www.w3.org/TR/REC-html40/loose.dtd">
<html>
  <head>
    <title>DynamicJava Incompatibilities With Java</title>

    <meta name="description" content="DynamicJava Incompatibilities With Java">
    <meta name="keywords" content="DynamicJava, incompatibilities, Java">
    <meta name="author" content="Stephane Hillion">
    <link rel="stylesheet" type="text/css" href="stylesheet.css">
  </head>

  <body bgcolor="white">
    <img src="images/oil-koala.gif"
         alt="Logo"
         width="140"
         height="87">
    <img src="images/dj-logo.gif"
         alt="DynamicJava"
         width="426"
         height="72"><br>

    <hr noshade>

    <!-- ############  'incompatibilities' ########### -->

    <p><img src="images/incompatibilities.gif"
	    alt="DynamicJava Incompatibilities With Java"
	    width="390"
            height="33"><br>

      <blockquote>
      There are some (known) incompatiblities of DynamicJava with the Java Language
      Specification:
      <h2>Constant strings equality test</h2>
      Constant strings are not shared. An expression like
      <code>"Abc" == "Abc"</code> or <code>"Abc" == "Ab" + "c"</code>
      returns <code>false</code> with DynamicJava and <code>true</code>
      with Java<sup class="small">TM</sup></li>.
      
      <h2>Implicit use of the default ClassLoader</h2>
      Since each DynamicJava interpreter instance use its own ClassLoader to
      load and create classes, the methods that make an implicit use of the default
      ClassLoader (like for example <code> Class.forName</code>)
      can be the source of a different behaviour between the
      interpreted and the compiled programs.

      <h2>Named local classes</h2>
      Named local classes are not yet implemented. All other sort of inner-classes
      are interpreted.

      <h2>Local classes using final variables in the redefinition of a method called
      in the constructor of the superclass</h2>
      The following program demontrates the problem
      (<a href="sources/Problem.java">Problem.java</a>):
    <pre>
<span class="reference">public</span> <span class="keyword">class</span> <span class="function-name">Problem</span> {
    <span class="reference">public</span> <span class="type">static</span> <span class="type">void</span> <span class="function-name">main</span>(<span class="type">String</span>[] <span class="variable-name">args</span>) {
	<span class="type">final</span> <span class="type">int</span> <span class="variable-name">i</span> = 123;
	<span class="keyword">new</span> <span class="type">C</span>() {
	    <span class="type">int</span> <span class="function-name">m</span>() {
		<span class="keyword">return</span> i;
	    }
	};
    }
}

<span class="type">abstract</span> <span class="keyword">class</span> <span class="function-name">C</span> {
    <span class="function-name">C</span>() {
	System.out.println("<span class="string">m() = </span>" + m());
    }
    <span class="type">abstract</span> <span class="type">int</span> <span class="function-name">m</span>();
}
    </pre>
      <p>This program, when compiled to bytecodes, produces the output:
	<blockquote>
	  <code>m() = 0</code> (instead of <code>m() = 123</code> like expected)
          for implementation reasons.
	</blockquote>
      <p>Interpreted with DynamicJava it launches an exception, again for
      implementation reasons.<br>
      Since the result returned by the compiled program is error-prone,
      it is not a bad thing that DynamicJava stops the execution of the interpreted program.
      </blockquote>
    
    <hr noshade>

    <div class="small">
      Send comments, suggestions and bug reports to
      <a class="mailto" href="mailto:shillion@ilog.fr">
	shillion@ilog.fr</a><br>

<!-- Created: Wed Aug  4 11:22:38 MET DST 1999 -->
<!-- hhmts start -->
Last modified: Tue Oct 26 11:48:00 MEST 1999
<!-- hhmts end -->
    </div>
    <hr noshade>
  </body>
</html>
